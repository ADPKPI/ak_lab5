## Архітектура комп'ютерів 2. Процесори
### Лабораторна робота №5
**«Розроблення модулів Linux Kernel (частина 2)»**

**Виконав:**  
студент групи ІО-23  
**Прохоренко А.Д.**  

---

## Опис завдання

Завдання передбачає модифікацію роботи №4 шляхом розділення проєкту на два окремі модулі ядра Linux: **hello1** та **hello2**. Головна мета — використання функцій одного модуля в іншому за допомогою **EXPORT_SYMBOL**.

## Модифікації

1. **Розділення проєкту на два модулі**:
   - **hello1.c**:
     - Реалізує функцію `print_hello()`, що друкує привітання задану кількість разів.
     - Функція експортується для використання в інших модулях через `EXPORT_SYMBOL(print_hello)`. 
     - Робота зі структурою списку (`struct list_head`) для збереження часу викликів функції.
     - Додано два поля типу `ktime_t` для вимірювання часу до та після виклику функції друку.
     - Під час вивантаження модуля виводиться час, витрачений на кожен виклик.

   - **hello2.c**:
     - Містить параметр `count` для вказання кількості викликів функції `print_hello()`.
     - Використовує функцію `print_hello()` з модуля `hello1` для друку привітань.

2. **Створення заголовкового файлу**:
   - Заголовковий файл `hello1.h` створено у підкаталозі `inc`.
   - Файл містить декларацію функції `print_hello()` для спільного використання обома модулями.
   - Підключення заголовкового файлу здійснюється за допомогою `#include "hello1.h"`.

3. **Makefile**:
   - Додано підтримку підкаталогу `inc` через директиву `ccflags-y`.
   - Збірка обох модулів:
     ```makefile
     obj-m += hello1.o
     obj-m += hello2.o
     ccflags-y := -I$(PWD)/inc
     ```

4. **Заміна `printk` на `pr_*`**:
   - `pr_info()` використовується для друку привітань.
   - `pr_warn()` — для попереджень.
   - `pr_err()` — для критичних помилок.

---

## Тестування

Тест демонструє неможливість завантаження модуля `hello2.ko`, якщо модуль `hello1.ko` не завантажений. Це відбувається через відсутність визначення функції `print_hello()`, яка експортується у модулі `hello1` за допомогою `EXPORT_SYMBOL`. При завантаженні `hello2` ядро намагається знайти символ `print_hello`, але через відсутність модуля `hello1` ця функція недоступна, і завантаження завершується помилкою. У логах видно повідомлення про невідомий символ.
